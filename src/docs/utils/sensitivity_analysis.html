<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>utils.sensitivity_analysis API documentation</title>
<meta name="description" content="This file contains the SensitivityAnalyser class …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>utils.sensitivity_analysis</code></h1>
</header>
<section id="section-intro">
<p>This file contains the SensitivityAnalyser class.</p>
<p>The SensitivityAnalyser is based on the SALib library.</p>
<p><strong>author</strong> = Louis Weyland
<strong>date</strong>
= 5/05/2022</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;This file contains the SensitivityAnalyser class.

The SensitivityAnalyser is based on the SALib library.

__author__ = Louis Weyland
__date__   = 5/05/2022
&#34;&#34;&#34;
import datetime
import functools
import logging
import multiprocessing
import os
from collections import OrderedDict
from typing import Any
from typing import Callable
from typing import Dict
from typing import List
from typing import Tuple
from typing import TypeVar

import numpy as np
import pandas as pd
from p_tqdm import p_map
from SALib.analyze import sobol
from SALib.sample import saltelli
from config.config import ConfigParser
from network_utils.network_converter import NetworkConverter
from network_utils.network_reader import NetworkReader
from simulators.sim_mart_vaq import SimMartVaq

logger = logging.getLogger(&#34;logger&#34;)

SA = TypeVar(&#34;SA&#34;, bound=&#34;SensitivityAnalyser&#34;)


class SensitivityAnalyser(ConfigParser):
    &#34;&#34;&#34;Performs sensitivity analysis on different models.&#34;&#34;&#34;

    def __init__(self) -&gt; None:
        &#34;&#34;&#34;Inherit from Configparser.&#34;&#34;&#34;
        super().__init__()

    def save_results(func: Callable) -&gt; Any:
        &#34;&#34;&#34;Save the sensitivity analysis results.

        Acts as a wrapper and must be at the top of the class
        &#34;&#34;&#34;

        @functools.wraps(func)
        def wrapper_decorator(self: SA, *args: Tuple, **kwargs: Dict[str, Any]) -&gt; Any:
            value = func(self, *args, **kwargs)
            # Save results
            if self.args.save:
                # Get timestamp
                e = datetime.datetime.now()
                timestamp = e.strftime(&#34;%d-%m-%Y-%H-%M&#34;)
                # Get the saving directory
                # Get directory first
                path = os.getcwd()
                par_dir = os.path.abspath(os.path.join(path))
                # par_dir = ../src/
                savig_dir = par_dir + &#34;/results/data/sensitivity_analysis/&#34;
                file_name = (
                    savig_dir
                    + func.__name__
                    + &#34;_&#34;
                    + str(kwargs[&#34;output_value&#34;])
                    + &#34;_r_&#34;
                    + str(kwargs[&#34;rounds&#34;])
                    + &#34;_n_s_&#34;
                    + str(kwargs[&#34;n_samples&#34;])
                    + &#34;_&#34;
                    + timestamp
                )

                df_list = value.to_df()
                df = pd.concat([df_list[0], df_list[1], df_list[2]], axis=1)
                with open(file_name, &#34;w&#34;) as fo:
                    fo.write(df.__repr__())

            return value

        return wrapper_decorator

    @save_results
    def sim_mart_vaq_sa(
        self, output_value: str, n_samples: int, rounds: int, problem: dict = None
    ) -&gt; Dict[str, List[float]]:
        &#34;&#34;&#34;Perform a sensitivity analysis on the Martinez-Vaquero model.

        The analysis is limited on &#34;delta&#34;,&#34;tau&#34;,&#34;gamma&#34;,&#34;beta_s&#34;,&#34;beta_h&#34; and &#34;beta_c&#34;.
        For the sake of time, no sensitivity analysis is conducted on the ration of h/w/c.
        Actually, h/w/c are correlated and would therefore return falsified Sobol results.
        Furthermore, the importance of the two parameters, temperature or the probability
        of random mutation is known. If the temperature is too high, the system will have
        random chaotic switched between status. If the probability of random mutation is high,
        the system with converge to a ration of 0.33 for h/w/c. What is interesting is to see the
        importance of the investigation stage as well as the influence of criminals on lone wolfs.
        Also it is interesting to see, what influence the penalty on the whole criminal organisation
        can have.

        Args:
            network  (gt.graph): Criminal network
            output_value  (str): Name of the interested output value such as
                                    [&#39;ratio_honest&#39;,&#39;ratio_wolf&#39;,&#39;ratio_criminal&#39;
                                    &#39;fitness_honest&#39;,&#39;fitness_criminal&#39;,&#39;fitness_wolf]
            problem      (dict): Define which variables to conduct sensitivity analysis
                                    with defining the bounds
            n_samples     (int): Define the size of the search space
            rounds        (int); Define the number of rounds played in the Simulation
        &#34;&#34;&#34;
        # Get the network of criminal first
        nx_network = NetworkReader().get_data(self.args.read_data)
        gt_network = NetworkConverter.nx_to_gt(nx_network)

        if problem is None:
            problem = {
                &#34;num_vars&#34;: 6,
                &#34;names&#34;: [
                    &#34;delta&#34;,
                    &#34;tau&#34;,
                    &#34;gamma&#34;,
                    &#34;beta_s&#34;,
                    &#34;beta_h&#34;,
                    &#34;beta_c&#34;,
                ],
                &#34;bounds&#34;: [[0, 1], [0, 1], [0, 1], [0, 200], [0, 200], [0, 200]],
            }
        # sample
        param_values = saltelli.sample(problem, n_samples)

        # ((number of loops*rounds/average_time_per_round)/n_threads)/ convert_to_hours
        approx_running_time = ((len(param_values) * rounds * (45 / 1000)) / 23) / 3600
        logger.warning(
            f&#34;The sensitivity analysis will take approx {approx_running_time:.2f}h on\
            24 cpus (~ 3.8 GHz))&#34;
        )
        # Running multiprocessing
        num_cpus = multiprocessing.cpu_count() - 1
        Y = p_map(
            self.sim_mart_vaq_sa_helper,
            (
                [
                    (gt_network, problem, params, output_value, rounds)
                    for params in param_values
                ]
            ),
            **{&#34;num_cpus&#34;: num_cpus, &#34;desc&#34;: &#34;Running sensitivity analysis&#34;},
        )

        Y_array = np.asarray(Y)

        # analyse
        sobol_indices = sobol.analyze(problem, Y_array)
        return sobol_indices

    def sim_mart_vaq_sa_helper(self, tuple_of_variable: Any) -&gt; float:
        &#34;&#34;&#34;Run the simulation Mart-Vaq given the parameter.&#34;&#34;&#34;
        # Set the seed each time, otherwise the simulation will be exactly the same
        np.random.seed()
        gt_network, problem, params, output_value, rounds = tuple_of_variable

        # Unpack input variables
        variable_dict = OrderedDict().fromkeys(problem[&#34;names&#34;], 0)
        variable_dict = dict(zip(variable_dict.keys(), params))

        simulator = SimMartVaq(network=gt_network, **variable_dict)
        _, data_collector = simulator.play(network=simulator.network, rounds=rounds)
        return data_collector[output_value][-1]</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="utils.sensitivity_analysis.SensitivityAnalyser"><code class="flex name class">
<span>class <span class="ident">SensitivityAnalyser</span></span>
</code></dt>
<dd>
<div class="desc"><p>Performs sensitivity analysis on different models.</p>
<p>Inherit from Configparser.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SensitivityAnalyser(ConfigParser):
    &#34;&#34;&#34;Performs sensitivity analysis on different models.&#34;&#34;&#34;

    def __init__(self) -&gt; None:
        &#34;&#34;&#34;Inherit from Configparser.&#34;&#34;&#34;
        super().__init__()

    def save_results(func: Callable) -&gt; Any:
        &#34;&#34;&#34;Save the sensitivity analysis results.

        Acts as a wrapper and must be at the top of the class
        &#34;&#34;&#34;

        @functools.wraps(func)
        def wrapper_decorator(self: SA, *args: Tuple, **kwargs: Dict[str, Any]) -&gt; Any:
            value = func(self, *args, **kwargs)
            # Save results
            if self.args.save:
                # Get timestamp
                e = datetime.datetime.now()
                timestamp = e.strftime(&#34;%d-%m-%Y-%H-%M&#34;)
                # Get the saving directory
                # Get directory first
                path = os.getcwd()
                par_dir = os.path.abspath(os.path.join(path))
                # par_dir = ../src/
                savig_dir = par_dir + &#34;/results/data/sensitivity_analysis/&#34;
                file_name = (
                    savig_dir
                    + func.__name__
                    + &#34;_&#34;
                    + str(kwargs[&#34;output_value&#34;])
                    + &#34;_r_&#34;
                    + str(kwargs[&#34;rounds&#34;])
                    + &#34;_n_s_&#34;
                    + str(kwargs[&#34;n_samples&#34;])
                    + &#34;_&#34;
                    + timestamp
                )

                df_list = value.to_df()
                df = pd.concat([df_list[0], df_list[1], df_list[2]], axis=1)
                with open(file_name, &#34;w&#34;) as fo:
                    fo.write(df.__repr__())

            return value

        return wrapper_decorator

    @save_results
    def sim_mart_vaq_sa(
        self, output_value: str, n_samples: int, rounds: int, problem: dict = None
    ) -&gt; Dict[str, List[float]]:
        &#34;&#34;&#34;Perform a sensitivity analysis on the Martinez-Vaquero model.

        The analysis is limited on &#34;delta&#34;,&#34;tau&#34;,&#34;gamma&#34;,&#34;beta_s&#34;,&#34;beta_h&#34; and &#34;beta_c&#34;.
        For the sake of time, no sensitivity analysis is conducted on the ration of h/w/c.
        Actually, h/w/c are correlated and would therefore return falsified Sobol results.
        Furthermore, the importance of the two parameters, temperature or the probability
        of random mutation is known. If the temperature is too high, the system will have
        random chaotic switched between status. If the probability of random mutation is high,
        the system with converge to a ration of 0.33 for h/w/c. What is interesting is to see the
        importance of the investigation stage as well as the influence of criminals on lone wolfs.
        Also it is interesting to see, what influence the penalty on the whole criminal organisation
        can have.

        Args:
            network  (gt.graph): Criminal network
            output_value  (str): Name of the interested output value such as
                                    [&#39;ratio_honest&#39;,&#39;ratio_wolf&#39;,&#39;ratio_criminal&#39;
                                    &#39;fitness_honest&#39;,&#39;fitness_criminal&#39;,&#39;fitness_wolf]
            problem      (dict): Define which variables to conduct sensitivity analysis
                                    with defining the bounds
            n_samples     (int): Define the size of the search space
            rounds        (int); Define the number of rounds played in the Simulation
        &#34;&#34;&#34;
        # Get the network of criminal first
        nx_network = NetworkReader().get_data(self.args.read_data)
        gt_network = NetworkConverter.nx_to_gt(nx_network)

        if problem is None:
            problem = {
                &#34;num_vars&#34;: 6,
                &#34;names&#34;: [
                    &#34;delta&#34;,
                    &#34;tau&#34;,
                    &#34;gamma&#34;,
                    &#34;beta_s&#34;,
                    &#34;beta_h&#34;,
                    &#34;beta_c&#34;,
                ],
                &#34;bounds&#34;: [[0, 1], [0, 1], [0, 1], [0, 200], [0, 200], [0, 200]],
            }
        # sample
        param_values = saltelli.sample(problem, n_samples)

        # ((number of loops*rounds/average_time_per_round)/n_threads)/ convert_to_hours
        approx_running_time = ((len(param_values) * rounds * (45 / 1000)) / 23) / 3600
        logger.warning(
            f&#34;The sensitivity analysis will take approx {approx_running_time:.2f}h on\
            24 cpus (~ 3.8 GHz))&#34;
        )
        # Running multiprocessing
        num_cpus = multiprocessing.cpu_count() - 1
        Y = p_map(
            self.sim_mart_vaq_sa_helper,
            (
                [
                    (gt_network, problem, params, output_value, rounds)
                    for params in param_values
                ]
            ),
            **{&#34;num_cpus&#34;: num_cpus, &#34;desc&#34;: &#34;Running sensitivity analysis&#34;},
        )

        Y_array = np.asarray(Y)

        # analyse
        sobol_indices = sobol.analyze(problem, Y_array)
        return sobol_indices

    def sim_mart_vaq_sa_helper(self, tuple_of_variable: Any) -&gt; float:
        &#34;&#34;&#34;Run the simulation Mart-Vaq given the parameter.&#34;&#34;&#34;
        # Set the seed each time, otherwise the simulation will be exactly the same
        np.random.seed()
        gt_network, problem, params, output_value, rounds = tuple_of_variable

        # Unpack input variables
        variable_dict = OrderedDict().fromkeys(problem[&#34;names&#34;], 0)
        variable_dict = dict(zip(variable_dict.keys(), params))

        simulator = SimMartVaq(network=gt_network, **variable_dict)
        _, data_collector = simulator.play(network=simulator.network, rounds=rounds)
        return data_collector[output_value][-1]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>config.config.ConfigParser</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="utils.sensitivity_analysis.SensitivityAnalyser.save_results"><code class="name flex">
<span>def <span class="ident">save_results</span></span>(<span>func: Callable) ‑> Any</span>
</code></dt>
<dd>
<div class="desc"><p>Save the sensitivity analysis results.</p>
<p>Acts as a wrapper and must be at the top of the class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_results(func: Callable) -&gt; Any:
    &#34;&#34;&#34;Save the sensitivity analysis results.

    Acts as a wrapper and must be at the top of the class
    &#34;&#34;&#34;

    @functools.wraps(func)
    def wrapper_decorator(self: SA, *args: Tuple, **kwargs: Dict[str, Any]) -&gt; Any:
        value = func(self, *args, **kwargs)
        # Save results
        if self.args.save:
            # Get timestamp
            e = datetime.datetime.now()
            timestamp = e.strftime(&#34;%d-%m-%Y-%H-%M&#34;)
            # Get the saving directory
            # Get directory first
            path = os.getcwd()
            par_dir = os.path.abspath(os.path.join(path))
            # par_dir = ../src/
            savig_dir = par_dir + &#34;/results/data/sensitivity_analysis/&#34;
            file_name = (
                savig_dir
                + func.__name__
                + &#34;_&#34;
                + str(kwargs[&#34;output_value&#34;])
                + &#34;_r_&#34;
                + str(kwargs[&#34;rounds&#34;])
                + &#34;_n_s_&#34;
                + str(kwargs[&#34;n_samples&#34;])
                + &#34;_&#34;
                + timestamp
            )

            df_list = value.to_df()
            df = pd.concat([df_list[0], df_list[1], df_list[2]], axis=1)
            with open(file_name, &#34;w&#34;) as fo:
                fo.write(df.__repr__())

        return value

    return wrapper_decorator</code></pre>
</details>
</dd>
<dt id="utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa"><code class="name flex">
<span>def <span class="ident">sim_mart_vaq_sa</span></span>(<span>self, output_value: str, n_samples: int, rounds: int, problem: dict = None) ‑> Dict[str, List[float]]</span>
</code></dt>
<dd>
<div class="desc"><p>Perform a sensitivity analysis on the Martinez-Vaquero model.</p>
<p>The analysis is limited on "delta","tau","gamma","beta_s","beta_h" and "beta_c".
For the sake of time, no sensitivity analysis is conducted on the ration of h/w/c.
Actually, h/w/c are correlated and would therefore return falsified Sobol results.
Furthermore, the importance of the two parameters, temperature or the probability
of random mutation is known. If the temperature is too high, the system will have
random chaotic switched between status. If the probability of random mutation is high,
the system with converge to a ration of 0.33 for h/w/c. What is interesting is to see the
importance of the investigation stage as well as the influence of criminals on lone wolfs.
Also it is interesting to see, what influence the penalty on the whole criminal organisation
can have.</p>
<h2 id="args">Args</h2>
<p>network
(gt.graph): Criminal network
output_value
(str): Name of the interested output value such as
['ratio_honest','ratio_wolf','ratio_criminal'
'fitness_honest','fitness_criminal','fitness_wolf]
problem
(dict): Define which variables to conduct sensitivity analysis
with defining the bounds
n_samples
(int): Define the size of the search space
rounds
(int); Define the number of rounds played in the Simulation</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@save_results
def sim_mart_vaq_sa(
    self, output_value: str, n_samples: int, rounds: int, problem: dict = None
) -&gt; Dict[str, List[float]]:
    &#34;&#34;&#34;Perform a sensitivity analysis on the Martinez-Vaquero model.

    The analysis is limited on &#34;delta&#34;,&#34;tau&#34;,&#34;gamma&#34;,&#34;beta_s&#34;,&#34;beta_h&#34; and &#34;beta_c&#34;.
    For the sake of time, no sensitivity analysis is conducted on the ration of h/w/c.
    Actually, h/w/c are correlated and would therefore return falsified Sobol results.
    Furthermore, the importance of the two parameters, temperature or the probability
    of random mutation is known. If the temperature is too high, the system will have
    random chaotic switched between status. If the probability of random mutation is high,
    the system with converge to a ration of 0.33 for h/w/c. What is interesting is to see the
    importance of the investigation stage as well as the influence of criminals on lone wolfs.
    Also it is interesting to see, what influence the penalty on the whole criminal organisation
    can have.

    Args:
        network  (gt.graph): Criminal network
        output_value  (str): Name of the interested output value such as
                                [&#39;ratio_honest&#39;,&#39;ratio_wolf&#39;,&#39;ratio_criminal&#39;
                                &#39;fitness_honest&#39;,&#39;fitness_criminal&#39;,&#39;fitness_wolf]
        problem      (dict): Define which variables to conduct sensitivity analysis
                                with defining the bounds
        n_samples     (int): Define the size of the search space
        rounds        (int); Define the number of rounds played in the Simulation
    &#34;&#34;&#34;
    # Get the network of criminal first
    nx_network = NetworkReader().get_data(self.args.read_data)
    gt_network = NetworkConverter.nx_to_gt(nx_network)

    if problem is None:
        problem = {
            &#34;num_vars&#34;: 6,
            &#34;names&#34;: [
                &#34;delta&#34;,
                &#34;tau&#34;,
                &#34;gamma&#34;,
                &#34;beta_s&#34;,
                &#34;beta_h&#34;,
                &#34;beta_c&#34;,
            ],
            &#34;bounds&#34;: [[0, 1], [0, 1], [0, 1], [0, 200], [0, 200], [0, 200]],
        }
    # sample
    param_values = saltelli.sample(problem, n_samples)

    # ((number of loops*rounds/average_time_per_round)/n_threads)/ convert_to_hours
    approx_running_time = ((len(param_values) * rounds * (45 / 1000)) / 23) / 3600
    logger.warning(
        f&#34;The sensitivity analysis will take approx {approx_running_time:.2f}h on\
        24 cpus (~ 3.8 GHz))&#34;
    )
    # Running multiprocessing
    num_cpus = multiprocessing.cpu_count() - 1
    Y = p_map(
        self.sim_mart_vaq_sa_helper,
        (
            [
                (gt_network, problem, params, output_value, rounds)
                for params in param_values
            ]
        ),
        **{&#34;num_cpus&#34;: num_cpus, &#34;desc&#34;: &#34;Running sensitivity analysis&#34;},
    )

    Y_array = np.asarray(Y)

    # analyse
    sobol_indices = sobol.analyze(problem, Y_array)
    return sobol_indices</code></pre>
</details>
</dd>
<dt id="utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa_helper"><code class="name flex">
<span>def <span class="ident">sim_mart_vaq_sa_helper</span></span>(<span>self, tuple_of_variable: Any) ‑> float</span>
</code></dt>
<dd>
<div class="desc"><p>Run the simulation Mart-Vaq given the parameter.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sim_mart_vaq_sa_helper(self, tuple_of_variable: Any) -&gt; float:
    &#34;&#34;&#34;Run the simulation Mart-Vaq given the parameter.&#34;&#34;&#34;
    # Set the seed each time, otherwise the simulation will be exactly the same
    np.random.seed()
    gt_network, problem, params, output_value, rounds = tuple_of_variable

    # Unpack input variables
    variable_dict = OrderedDict().fromkeys(problem[&#34;names&#34;], 0)
    variable_dict = dict(zip(variable_dict.keys(), params))

    simulator = SimMartVaq(network=gt_network, **variable_dict)
    _, data_collector = simulator.play(network=simulator.network, rounds=rounds)
    return data_collector[output_value][-1]</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="utils" href="index.html">utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="utils.sensitivity_analysis.SensitivityAnalyser" href="#utils.sensitivity_analysis.SensitivityAnalyser">SensitivityAnalyser</a></code></h4>
<ul class="">
<li><code><a title="utils.sensitivity_analysis.SensitivityAnalyser.save_results" href="#utils.sensitivity_analysis.SensitivityAnalyser.save_results">save_results</a></code></li>
<li><code><a title="utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa" href="#utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa">sim_mart_vaq_sa</a></code></li>
<li><code><a title="utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa_helper" href="#utils.sensitivity_analysis.SensitivityAnalyser.sim_mart_vaq_sa_helper">sim_mart_vaq_sa_helper</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>
